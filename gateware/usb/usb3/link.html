<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Link &mdash; SOL 0.2.1.dev25 documentation</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/styles.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/platformpicker.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/styles.css" type="text/css" />
    <link rel="canonical" href="https://sol.shmdn.link/gateware/usb/usb3/link.html" />
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/sphinx_highlight.js"></script>
        <script src="../../../_static/platformpicker.js"></script>
        <script src="../../../_static/wavedrom.skin.js"></script>
        <script src="../../../_static/wavedrom.min.js"></script>
        <script src="../../../_static/js/wavedrom.min.js"></script>
        <script src="../../../_static/js/wavedrom.skin.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Physical" href="physical.html" />
    <link rel="prev" title="Endpoints" href="endpoints.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            SOL
          </a>
              <div class="version">
                latest
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../features.html">Status &amp; Support</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../features.html#support-for-device-mode">Support for Device Mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../features.html#support-for-host-mode">Support for Host Mode</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../install.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../install.html#installing-prerequisites">Installing Prerequisites</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../install.html#installing-python">Installing Python</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../install.html#installing-yosys">Installing Yosys</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../install.html#installing-torii">Installing Torii</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../install.html#installing-sol">Installing SOL</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../install.html#latest-release">Latest release</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../install.html#development-snapshot">Development snapshot</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../install.html#editable-development-snapshot">Editable development snapshot</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../getting_started.html">Getting Started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../getting_started.html#prerequisites">Prerequisites</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorials/index.html">Tutorials</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">Gateware Library</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../interface/index.html">Interface</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../interface/pipe.html">PIPE</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../interface/pipe.html#sol_usb.gateware.interface.pipe.PIPEInterface"><code class="docutils literal notranslate"><span class="pre">PIPEInterface</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../interface/pipe.html#sol_usb.gateware.interface.pipe.AsyncPIPEInterface"><code class="docutils literal notranslate"><span class="pre">AsyncPIPEInterface</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../interface/pipe.html#sol_usb.gateware.interface.pipe.GearedPIPEInterface"><code class="docutils literal notranslate"><span class="pre">GearedPIPEInterface</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../interface/ulpi.html">ULPI</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../interface/ulpi.html#sol_usb.gateware.interface.ulpi.ULPIInterface"><code class="docutils literal notranslate"><span class="pre">ULPIInterface</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../interface/ulpi.html#sol_usb.gateware.interface.ulpi.ULPIRegisterWindow"><code class="docutils literal notranslate"><span class="pre">ULPIRegisterWindow</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../interface/ulpi.html#sol_usb.gateware.interface.ulpi.ULPIRxEventDecoder"><code class="docutils literal notranslate"><span class="pre">ULPIRxEventDecoder</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../interface/ulpi.html#sol_usb.gateware.interface.ulpi.ULPIControlTranslator"><code class="docutils literal notranslate"><span class="pre">ULPIControlTranslator</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../interface/ulpi.html#sol_usb.gateware.interface.ulpi.ULPITransmitTranslator"><code class="docutils literal notranslate"><span class="pre">ULPITransmitTranslator</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../interface/ulpi.html#sol_usb.gateware.interface.ulpi.UTMITranslator"><code class="docutils literal notranslate"><span class="pre">UTMITranslator</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../interface/utmi.html">UTMI</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../interface/utmi.html#sol_usb.gateware.interface.utmi.UTMIOperatingMode"><code class="docutils literal notranslate"><span class="pre">UTMIOperatingMode</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../interface/utmi.html#sol_usb.gateware.interface.utmi.UTMITerminationSelect"><code class="docutils literal notranslate"><span class="pre">UTMITerminationSelect</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../interface/utmi.html#sol_usb.gateware.interface.utmi.UTMITransmitInterface"><code class="docutils literal notranslate"><span class="pre">UTMITransmitInterface</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../interface/utmi.html#sol_usb.gateware.interface.utmi.UTMIInterfaceMultiplexer"><code class="docutils literal notranslate"><span class="pre">UTMIInterfaceMultiplexer</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../interface/utmi.html#sol_usb.gateware.interface.utmi.UTMIInterface"><code class="docutils literal notranslate"><span class="pre">UTMIInterface</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../interface/gateware/index.html">Gateware PHY</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../interface/gateware/phy.html">Gateware PHY</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../interface/gateware/receiver.html">Gateware PHY - Receiver</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../interface/gateware/transmitter.html">Gateware PHY - Transmitter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../interface/gateware/index.html#sol_usb.gateware.interface.gateware_phy.GatewarePHY"><code class="docutils literal notranslate"><span class="pre">GatewarePHY</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../interface/serdes/index.html">SerDes PHY</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../interface/serdes/ecp5.html">SerDes PHY - ECP5</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../interface/serdes/lfps.html">SerDes PHY - LFPS</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../interface/serdes/xc7.html">SerDes PHY - XC7</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../interface/serdes/index.html#sol_usb.gateware.interface.serdes_phy.ECP5SerDesPIPE"><code class="docutils literal notranslate"><span class="pre">ECP5SerDesPIPE</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../interface/serdes/index.html#sol_usb.gateware.interface.serdes_phy.XC7GTPSerDesPIPE"><code class="docutils literal notranslate"><span class="pre">XC7GTPSerDesPIPE</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../interface/serdes/index.html#sol_usb.gateware.interface.serdes_phy.XC7GTXSerDesPIPE"><code class="docutils literal notranslate"><span class="pre">XC7GTXSerDesPIPE</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../soc/index.html">SoC</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../soc/cpu.html">CPU</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../soc/event.html">Event</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../soc/memory.html">Memory</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../soc/memory.html#sol_usb.gateware.soc.memory.WishboneRAM"><code class="docutils literal notranslate"><span class="pre">WishboneRAM</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../soc/memory.html#sol_usb.gateware.soc.memory.WishboneROM"><code class="docutils literal notranslate"><span class="pre">WishboneROM</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../soc/peripheral.html">Peripheral</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../soc/simplesoc.html">SimpleSoC</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../soc/uart.html">UART</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../stream/index.html">Stream</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../stream/index.html#sol_usb.gateware.stream.StreamInterface"><code class="docutils literal notranslate"><span class="pre">StreamInterface</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../stream/index.html#sol_usb.gateware.stream.StreamInterface.stream_eq"><code class="docutils literal notranslate"><span class="pre">StreamInterface.stream_eq()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../stream/index.html#sol_usb.gateware.stream.StreamInterface.tap"><code class="docutils literal notranslate"><span class="pre">StreamInterface.tap()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../stream/index.html#module-sol_usb.gateware.stream.arbiter">Arbiter</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../stream/index.html#sol_usb.gateware.stream.arbiter.StreamMultiplexer"><code class="docutils literal notranslate"><span class="pre">StreamMultiplexer</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../stream/index.html#sol_usb.gateware.stream.arbiter.StreamArbiter"><code class="docutils literal notranslate"><span class="pre">StreamArbiter</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../stream/index.html#module-sol_usb.gateware.stream.generator">Generator</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../stream/index.html#sol_usb.gateware.stream.generator.ConstantStreamGenerator"><code class="docutils literal notranslate"><span class="pre">ConstantStreamGenerator</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../stream/index.html#sol_usb.gateware.stream.generator.StreamSerializer"><code class="docutils literal notranslate"><span class="pre">StreamSerializer</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html">USB</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../analyzer.html">Analyzer</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../analyzer.html#sol_usb.gateware.usb.analyzer.USBAnalyzer"><code class="docutils literal notranslate"><span class="pre">USBAnalyzer</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../request.html">Request</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../request.html#module-sol_usb.gateware.usb.request.control">Control</a></li>
<li class="toctree-l4"><a class="reference internal" href="../request.html#module-sol_usb.gateware.usb.request.interface">Interface</a></li>
<li class="toctree-l4"><a class="reference internal" href="../request.html#module-sol_usb.gateware.usb.request.standard">Standard</a></li>
<li class="toctree-l4"><a class="reference internal" href="../request.html#module-sol_usb.gateware.usb.request.windows">Windows</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stream.html">Stream</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stream.html#sol_usb.gateware.usb.stream.USBInStreamInterface"><code class="docutils literal notranslate"><span class="pre">USBInStreamInterface</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stream.html#sol_usb.gateware.usb.stream.USBOutStreamInterface"><code class="docutils literal notranslate"><span class="pre">USBOutStreamInterface</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stream.html#sol_usb.gateware.usb.stream.USBOutStreamBoundaryDetector"><code class="docutils literal notranslate"><span class="pre">USBOutStreamBoundaryDetector</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stream.html#sol_usb.gateware.usb.stream.USBRawSuperSpeedStream"><code class="docutils literal notranslate"><span class="pre">USBRawSuperSpeedStream</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stream.html#sol_usb.gateware.usb.stream.SuperSpeedStreamArbiter"><code class="docutils literal notranslate"><span class="pre">SuperSpeedStreamArbiter</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stream.html#sol_usb.gateware.usb.stream.SuperSpeedStreamInterface"><code class="docutils literal notranslate"><span class="pre">SuperSpeedStreamInterface</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../usb2/index.html">USB2</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../usb2/control.html">Control</a></li>
<li class="toctree-l4"><a class="reference internal" href="../usb2/descriptor.html">Descriptor</a></li>
<li class="toctree-l4"><a class="reference internal" href="../usb2/deserializer.html">Deserializer</a></li>
<li class="toctree-l4"><a class="reference internal" href="../usb2/device.html">Device</a></li>
<li class="toctree-l4"><a class="reference internal" href="../usb2/endpoint.html">Endpoint</a></li>
<li class="toctree-l4"><a class="reference internal" href="../usb2/endpoint.html#gateware-endpoint-interfaces">Gateware Endpoint Interfaces</a></li>
<li class="toctree-l4"><a class="reference internal" href="../usb2/packet.html">Packet</a></li>
<li class="toctree-l4"><a class="reference internal" href="../usb2/request.html">Request</a></li>
<li class="toctree-l4"><a class="reference internal" href="../usb2/reset.html">Reset</a></li>
<li class="toctree-l4"><a class="reference internal" href="../usb2/transfer.html">Transfer</a></li>
<li class="toctree-l4"><a class="reference internal" href="../usb2/endpoints.html">Endpoints</a></li>
<li class="toctree-l4"><a class="reference internal" href="../usb2/interfaces.html">Interfaces</a></li>
<li class="toctree-l4"><a class="reference internal" href="../usb2/index.html#conceptual-components">Conceptual Components</a></li>
<li class="toctree-l4"><a class="reference internal" href="../usb2/index.html#token-detector">Token Detector</a></li>
<li class="toctree-l4"><a class="reference internal" href="../usb2/index.html#handshake-detector">Handshake Detector</a></li>
<li class="toctree-l4"><a class="reference internal" href="../usb2/index.html#data-packet-receiver">Data Packet Receiver</a></li>
<li class="toctree-l4"><a class="reference internal" href="../usb2/index.html#device-state-manager">Device State Manager</a></li>
<li class="toctree-l4"><a class="reference internal" href="../usb2/index.html#handshake-generator">Handshake Generator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../usb2/index.html#data-packet-transmitter">Data Packet Transmitter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../usb2/index.html#data-crc-unit">Data CRC Unit</a></li>
<li class="toctree-l4"><a class="reference internal" href="../usb2/index.html#interpacket-timer">Interpacket Timer</a></li>
<li class="toctree-l4"><a class="reference internal" href="../usb2/index.html#reset-suspend-sequencer">Reset/Suspend Sequencer</a></li>
</ul>
</li>
<li class="toctree-l3 current"><a class="reference internal" href="index.html">USB3</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="application.html">Application</a></li>
<li class="toctree-l4"><a class="reference internal" href="device.html">Device</a></li>
<li class="toctree-l4"><a class="reference internal" href="endpoints.html">Endpoints</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">Link</a></li>
<li class="toctree-l4"><a class="reference internal" href="physical.html">Physical</a></li>
<li class="toctree-l4"><a class="reference internal" href="protocol.html">Protocol</a></li>
<li class="toctree-l4"><a class="reference internal" href="request.html">Request</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../hardware/custom.html">SOL On Your Own Hardware</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../hardware/custom.html#high-speed-via-a-ulpi-phy">High-Speed via a ULPI PHY</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../hardware/custom.html#full-speed-using-fpga-i-o">Full-Speed using FPGA I/O</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../hardware/index.html">Hardware</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../changelog.html">Changelog</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../changelog.html#unreleased">Unreleased</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../changelog.html#added">Added</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../changelog.html#changed">Changed</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../changelog.html#deprecated">Deprecated</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../changelog.html#removed">Removed</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../changelog.html#fixed">Fixed</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../changelog.html#security">Security</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../changelog.html#id1">0.2.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../changelog.html#id2">Added</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../changelog.html#id3">Changed</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../changelog.html#id4">Removed</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../changelog.html#id5">Fixed</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../changelog.html#id6">0.1.0</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/shrine-maiden-heavy-industries/sol/">Source Code</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">SOL</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">Gateware Library</a></li>
          <li class="breadcrumb-item"><a href="../index.html">USB</a></li>
          <li class="breadcrumb-item"><a href="index.html">USB3</a></li>
      <li class="breadcrumb-item active">Link</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/shrine-maiden-heavy-industries/sol/blob/main/docs/gateware/usb/usb3/link.md" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-sol_usb.gateware.usb.usb3.link">
<span id="link"></span><h1>Link<a class="headerlink" href="#module-sol_usb.gateware.usb.usb3.link" title="Permalink to this heading"></a></h1>
<p>USB3 Link-Layer modules</p>
<dl class="py class">
<dt class="sig sig-object py" id="sol_usb.gateware.usb.usb3.link.USB3LinkLayer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sol_usb.gateware.usb.usb3.link.</span></span><span class="sig-name descname"><span class="pre">USB3LinkLayer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">src_loc_at</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sol_usb.gateware.usb.usb3.link.USB3LinkLayer" title="Permalink to this definition"></a></dt>
<dd><p>Abstraction encapsulating the USB3 link layer hardware.</p>
<p>Performs the lower-level data manipulations associated with transporting USB3 packets
from place to place.</p>
</dd></dl>

<section id="module-sol_usb.gateware.usb.usb3.link.command">
<span id="command"></span><h2>Command<a class="headerlink" href="#module-sol_usb.gateware.usb.usb3.link.command" title="Permalink to this heading"></a></h2>
<p>USB Link Commands Transmitter/Receivers</p>
<dl class="py class">
<dt class="sig sig-object py" id="sol_usb.gateware.usb.usb3.link.command.LinkCommandDetector">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sol_usb.gateware.usb.usb3.link.command.</span></span><span class="sig-name descname"><span class="pre">LinkCommandDetector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">src_loc_at</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sol_usb.gateware.usb.usb3.link.command.LinkCommandDetector" title="Permalink to this definition"></a></dt>
<dd><p>USB3 Link Command Detector.</p>
<p>This module detects USB3 link commands as they’re received on the bus.</p>
<dl class="field-list simple">
<dt class="field-odd">Variables<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sink</strong> (<a class="reference internal" href="../stream.html#sol_usb.gateware.usb.stream.USBRawSuperSpeedStream" title="sol_usb.gateware.usb.stream.USBRawSuperSpeedStream"><em>USBRawSuperSpeedStream</em></a><em>, </em><em>input stream</em>) – The (aligned and descrambled) data stream captured from the physical layer.</p></li>
<li><p><strong>command</strong> (<em>Signal</em><em>(</em><em>4</em><em>)</em><em>, </em><em>output</em>) – The link command; including its two-bit class and two-bit type.</p></li>
<li><p><strong>command_class</strong> (<em>Signal</em><em>(</em><em>2</em><em>)</em><em>, </em><em>output</em>) – The link command’s class; equivalent to the first two bits of :attr:<code class="docutils literal notranslate"><span class="pre">command</span></code>.</p></li>
<li><p><strong>command_type</strong> (<em>Signal</em><em>(</em><em>2</em><em>)</em><em>, </em><em>output</em>) – The link command’s type; equivalent to the second two bits of :attr:<code class="docutils literal notranslate"><span class="pre">command</span></code>.</p></li>
<li><p><strong>subtype</strong> (<em>Signal</em><em>(</em><em>4</em><em>)</em><em>, </em><em>output</em>) – The link command’s subtype.</p></li>
<li><p><strong>new_command</strong> (<em>signal</em><em>(</em><em>)</em><em>, </em><em>output</em>) – Strobe; indicates that a new link command has been received, and the details of this command
are ready to be read.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sol_usb.gateware.usb.usb3.link.command.LinkCommandGenerator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sol_usb.gateware.usb.usb3.link.command.</span></span><span class="sig-name descname"><span class="pre">LinkCommandGenerator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">src_loc_at</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sol_usb.gateware.usb.usb3.link.command.LinkCommandGenerator" title="Permalink to this definition"></a></dt>
<dd><p>USB3 Link Command Generator.</p>
<p>This module generates link commands on the USB3 bus.</p>
<dl class="field-list simple">
<dt class="field-odd">Variables<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>source</strong> (<a class="reference internal" href="../stream.html#sol_usb.gateware.usb.stream.USBRawSuperSpeedStream" title="sol_usb.gateware.usb.stream.USBRawSuperSpeedStream"><em>USBRawSuperSpeedStream</em></a><em>(</em><em>)</em><em>, </em><em>output stream</em>) – The data generated in sending our link commands.</p></li>
<li><p><strong>command</strong> (<em>Signal</em><em>(</em><em>4</em><em>)</em><em>, </em><em>output</em>) – The link command; including its two-bit class and two-bit type.</p></li>
<li><p><strong>subtype</strong> (<em>Signal</em><em>(</em><em>4</em><em>)</em><em>, </em><em>output</em>) – The link command’s subtype.</p></li>
<li><p><strong>generate</strong> (<em>Signal</em><em>(</em><em>)</em><em>, </em><em>input</em>) – Strobe; indicates that a link command should be generated.</p></li>
<li><p><strong>done</strong> (<em>Signal</em><em>(</em><em>)</em><em>, </em><em>output</em>) – Indicates that the link command will be complete this cycle; and thus this unit will
be ready to send another link command next cycle.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-sol_usb.gateware.usb.usb3.link.crc">
<span id="crc"></span><h2>CRC<a class="headerlink" href="#module-sol_usb.gateware.usb.usb3.link.crc" title="Permalink to this heading"></a></h2>
<p>CRC computation gateware for USB3.</p>
<dl class="py function">
<dt class="sig sig-object py" id="sol_usb.gateware.usb.usb3.link.crc.compute_usb_crc5">
<span class="sig-prename descclassname"><span class="pre">sol_usb.gateware.usb.usb3.link.crc.</span></span><span class="sig-name descname"><span class="pre">compute_usb_crc5</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">protected_bits</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sol_usb.gateware.usb.usb3.link.crc.compute_usb_crc5" title="Permalink to this definition"></a></dt>
<dd><p>Generates a 5-bit signal equivalent to the CRC5 check of a given 11-bits.</p>
<p>Intended for link command words / link control words.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>protected_bits</strong> (<em>11-bit Signal</em><em>(</em><em>)</em>) – The 11-bit signal to generate a CRC5 for.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A five-bit signal equivalent to the CRC5 of the protected bits.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Signal(5)</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sol_usb.gateware.usb.usb3.link.crc.HeaderPacketCRC">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sol_usb.gateware.usb.usb3.link.crc.</span></span><span class="sig-name descname"><span class="pre">HeaderPacketCRC</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">src_loc_at</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sol_usb.gateware.usb.usb3.link.crc.HeaderPacketCRC" title="Permalink to this definition"></a></dt>
<dd><p>Gateware that computes a running CRC-16 for the first three words of a header packet.</p>
<dl class="field-list simple">
<dt class="field-odd">Variables<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>clear</strong> (<em>Signal</em><em>(</em><em>)</em><em>, </em><em>input</em>) – Strobe; clears the CRC, restoring it to its Initial Value.</p></li>
<li><p><strong>data_input</strong> (<em>Signal</em><em>(</em><em>32</em><em>)</em><em>, </em><em>input</em>) – Data word to add to our running CRC.</p></li>
<li><p><strong>advance_crc</strong> (<em>Signal</em><em>(</em><em>)</em><em>, </em><em>input</em>) – When asserted, the current data input will be added to the CRC.</p></li>
<li><p><strong>crc</strong> (<em>Signal</em><em>(</em><em>16</em><em>)</em><em>, </em><em>output</em>) – The current CRC value.</p></li>
</ul>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>initial_value</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a><em>, </em><em>Const</em>) – The initial value of the CRC shift register; the USB default is used if not provided.</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sol_usb.gateware.usb.usb3.link.crc.DataPacketPayloadCRC">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sol_usb.gateware.usb.usb3.link.crc.</span></span><span class="sig-name descname"><span class="pre">DataPacketPayloadCRC</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">src_loc_at</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sol_usb.gateware.usb.usb3.link.crc.DataPacketPayloadCRC" title="Permalink to this definition"></a></dt>
<dd><p>Gateware that computes a running CRC-32 for a data packet payload.</p>
<p>This CRC is more complicated than others, as Data Packet Payloads are not
required to end on a word boundary. Accordingly, we’ll need to handle cases
where we have an incomplete word of 1, 2, or 3 bytes.</p>
<dl class="field-list simple">
<dt class="field-odd">Variables<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>clear</strong> (<em>Signal</em><em>(</em><em>)</em><em>, </em><em>input</em>) – Strobe; clears the CRC, restoring it to its Initial Value.</p></li>
<li><p><strong>data_input</strong> (<em>Signal</em><em>(</em><em>32</em><em>)</em><em>, </em><em>input</em>) – Data word to add to our running CRC.</p></li>
<li><p><strong>advance_word</strong> (<em>Signal</em><em>(</em><em>)</em><em>, </em><em>input</em>) – When asserted, the current data word will be added to our CRC.</p></li>
<li><p><strong>advance_3B</strong> (<em>Signal</em><em>(</em><em>)</em><em>, </em><em>input</em>) – When asserted, the last three bytes of the current data word will be added to our CRC.</p></li>
<li><p><strong>advance_2B</strong> (<em>Signal</em><em>(</em><em>)</em><em>, </em><em>input</em>) – When asserted, the last two bytes of the current data word will be added to our CRC.</p></li>
<li><p><strong>advance_1B</strong> (<em>Signal</em><em>(</em><em>)</em><em>, </em><em>input</em>) – When asserted, the last byte of the current data word will be added to our CRC.</p></li>
<li><p><strong>crc</strong> (<em>Signal</em><em>(</em><em>32</em><em>)</em><em>, </em><em>output</em>) – The current CRC value.</p></li>
<li><p><strong>next_crc_3B</strong> (<em>Signal</em><em>(</em><em>32</em><em>)</em><em>, </em><em>output</em>) – The CRC value for the next cycle, assuming we advance 3B.</p></li>
<li><p><strong>next_crc_2B</strong> (<em>Signal</em><em>(</em><em>32</em><em>)</em><em>, </em><em>output</em>) – The CRC value for the next cycle, assuming we advance 2B.</p></li>
<li><p><strong>next_crc_1B</strong> (<em>Signal</em><em>(</em><em>32</em><em>)</em><em>, </em><em>output</em>) – The CRC value for the next cycle, assuming we advance 1B.</p></li>
</ul>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>initial_value</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a><em>, </em><em>Const</em>) – The initial value of the CRC shift register; the USB default is used if not provided.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-sol_usb.gateware.usb.usb3.link.data">
<span id="data"></span><h2>Data<a class="headerlink" href="#module-sol_usb.gateware.usb.usb3.link.data" title="Permalink to this heading"></a></h2>
<p>Data Packet Payload (DPP) management gateware.</p>
<dl class="py class">
<dt class="sig sig-object py" id="sol_usb.gateware.usb.usb3.link.data.DataHeaderPacket">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sol_usb.gateware.usb.usb3.link.data.</span></span><span class="sig-name descname"><span class="pre">DataHeaderPacket</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sol_usb.gateware.usb.usb3.link.data.DataHeaderPacket" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sol_usb.gateware.usb.usb3.link.data.DataPacketReceiver">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sol_usb.gateware.usb.usb3.link.data.</span></span><span class="sig-name descname"><span class="pre">DataPacketReceiver</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">src_loc_at</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sol_usb.gateware.usb.usb3.link.data.DataPacketReceiver" title="Permalink to this definition"></a></dt>
<dd><p>Class that monitors the USB bus for data packets, and receives them.</p>
<p>This class has logic redundant with our Header Packet Receiver, to simplify data packet
reception. Accordingly, the header section of the data packet will be parsed here as well
as in the Header Packet receiver. This simplifies our structure at the expense of an additional
CRC-5 and CRC-16 unit.</p>
<p>This class performs the validations required at the link layer of the USB specification;
which include checking the CRC-5 and CRC-16 embedded within the header, and CRC-32 of the
data packet payload.</p>
<p>Header sequence number is not checked, here, as a sequence error will force recovery in the
Header Packet Receiver.</p>
<dl class="field-list simple">
<dt class="field-odd">Variables<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sink</strong> (<a class="reference internal" href="../stream.html#sol_usb.gateware.usb.stream.USBRawSuperSpeedStream" title="sol_usb.gateware.usb.stream.USBRawSuperSpeedStream"><em>USBRawSuperSpeedStream</em></a><em>(</em><em>)</em><em>, </em><em>input</em><em> (</em><em>monitor only</em><em>)</em>) – Stream that the USB data to be monitored.</p></li>
<li><p><strong>header</strong> (<a class="reference internal" href="#sol_usb.gateware.usb.usb3.link.header.HeaderPacket" title="sol_usb.gateware.usb.usb3.link.header.HeaderPacket"><em>HeaderPacket</em></a><em>(</em><em>)</em><em>, </em><em>output</em>) – The header packet accompanying the current data packet. Valid once a packet begins
to be received.</p></li>
<li><p><strong>new_header</strong> (<em>Signal</em><em>(</em><em>)</em><em>, </em><em>output</em>) – Strobe; indicates that :attr:<code class="docutils literal notranslate"><span class="pre">header</span></code> has been updated.</p></li>
<li><p><strong>source</strong> (<a class="reference internal" href="../../stream/index.html#sol_usb.gateware.stream.StreamInterface" title="sol_usb.gateware.stream.StreamInterface"><em>StreamInterface</em></a><em>(</em><em>)</em><em>, </em><em>output stream</em>) – A stream carrying the data received. Note that the data is not fully validated until
the packet has been fully received; so this cannot be assumed</p></li>
<li><p><strong>packet_good</strong> (<em>Signal</em><em>(</em><em>)</em><em>, </em><em>output</em>) – Strobe; indicates that the packet received passed validations and can be considered good.</p></li>
<li><p><strong>packet_bad</strong> (<em>Signal</em><em>(</em><em>)</em><em>, </em><em>output</em>) – Strobe; indicates that the packet failed CRC checks, or did not end properly.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sol_usb.gateware.usb.usb3.link.data.DataPacketTransmitter">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sol_usb.gateware.usb.usb3.link.data.</span></span><span class="sig-name descname"><span class="pre">DataPacketTransmitter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">src_loc_at</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sol_usb.gateware.usb.usb3.link.data.DataPacketTransmitter" title="Permalink to this definition"></a></dt>
<dd><p>Gateware that generates a Data Packet Header, and orchestrates sending it and a payload.</p>
<p>The actual sending is handled by our transmitter gateware.</p>
<dl class="field-list simple">
<dt class="field-odd">Variables<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_sink</strong> (<a class="reference internal" href="../stream.html#sol_usb.gateware.usb.stream.SuperSpeedStreamInterface" title="sol_usb.gateware.usb.stream.SuperSpeedStreamInterface"><em>SuperSpeedStreamInterface</em></a><em>(</em><em>)</em><em>, </em><em>input stream</em>) – The data stream to be send as a data packet. The length of this stream should match thee
length parameter.</p></li>
<li><p><strong>send_zlp</strong> (<em>Signal</em><em>(</em><em>)</em><em>, </em><em>input</em>) – Strobe; triggers sending of a zero-length packet.</p></li>
<li><p><strong>sequence_number</strong> (<em>Signal</em><em>(</em><em>5</em><em>)</em><em>, </em><em>input</em>) – The sequence number associated with the relevant data packet. Latched in once :attr:<code class="docutils literal notranslate"><span class="pre">data_sink</span></code> goes valid.</p></li>
<li><p><strong>endpoint_number</strong> (<em>Signal</em><em>(</em><em>4</em><em>)</em><em>, </em><em>input</em>) – The endpoint number associated with the relevant data stream. Latched in once :attr:<code class="docutils literal notranslate"><span class="pre">data_sink</span></code> goes valid.</p></li>
<li><p><strong>data_length</strong> (<em>Signal</em><em>(</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#range" title="(in Python v3.11)"><em>range</em></a><em>(</em><em>1024 + 1</em><em>)</em><em>)</em>) – The length of the data packet to be sent; in bytes. Latched in once :attr:<code class="docutils literal notranslate"><span class="pre">data_sink</span></code> goes valid.</p></li>
<li><p><strong>direction</strong> (<em>Signal</em><em>(</em><em>)</em><em>, </em><em>input</em>) – The direction to indicate in the data header packet. Typically Direction.IN; but will be Direction.OUT
when data is sent to the host as part of a control transfer.</p></li>
<li><p><strong>address</strong> (<em>Signal</em><em>(</em><em>7</em><em>)</em><em>, </em><em>input</em>) – The current address of the USB device.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-sol_usb.gateware.usb.usb3.link.header">
<span id="header"></span><h2>Header<a class="headerlink" href="#module-sol_usb.gateware.usb.usb3.link.header" title="Permalink to this heading"></a></h2>
<p>Header Packet data interfacing definitions.</p>
<dl class="py class">
<dt class="sig sig-object py" id="sol_usb.gateware.usb.usb3.link.header.HeaderPacket">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sol_usb.gateware.usb.usb3.link.header.</span></span><span class="sig-name descname"><span class="pre">HeaderPacket</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sol_usb.gateware.usb.usb3.link.header.HeaderPacket" title="Permalink to this definition"></a></dt>
<dd><p>Container that represents a Header Packet.</p>
<dl class="py method">
<dt class="sig sig-object py" id="sol_usb.gateware.usb.usb3.link.header.HeaderPacket.get_type">
<span class="sig-name descname"><span class="pre">get_type</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sol_usb.gateware.usb.usb3.link.header.HeaderPacket.get_type" title="Permalink to this definition"></a></dt>
<dd><p>Returns the selection of bits in DW0 that encode the packet type.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sol_usb.gateware.usb.usb3.link.header.HeaderPacket.get_layout">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_layout</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sol_usb.gateware.usb.usb3.link.header.HeaderPacket.get_layout" title="Permalink to this definition"></a></dt>
<dd><p>Computes the layout for the HeaderPacket (sub)class.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sol_usb.gateware.usb.usb3.link.header.HeaderQueue">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sol_usb.gateware.usb.usb3.link.header.</span></span><span class="sig-name descname"><span class="pre">HeaderQueue</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sol_usb.gateware.usb.usb3.link.header.HeaderQueue" title="Permalink to this definition"></a></dt>
<dd><p>Record representing a header, and stream-link control signals.</p>
<dl class="field-list simple">
<dt class="field-odd">Variables<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>valid</strong> (<em>Signal</em><em>(</em><em>)</em><em>, </em><em>producer to consumer</em>) – Indicates that the data in :attr:<code class="docutils literal notranslate"><span class="pre">header</span></code> is valid and ready to be consumed.</p></li>
<li><p><strong>header</strong> (<a class="reference internal" href="#sol_usb.gateware.usb.usb3.link.header.HeaderPacket" title="sol_usb.gateware.usb.usb3.link.header.HeaderPacket"><em>HeaderPacket</em></a><em>(</em><em>)</em><em>, </em><em>producer to consumer</em>) – Contains a full set of header packet data.</p></li>
<li><p><strong>ready</strong> (<em>Signal</em><em>(</em><em>)</em><em>, </em><em>consumer to producer</em>) – Strobed by the consumer to indicate that it has accepted the given header.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="sol_usb.gateware.usb.usb3.link.header.HeaderQueue.get_type">
<span class="sig-name descname"><span class="pre">get_type</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sol_usb.gateware.usb.usb3.link.header.HeaderQueue.get_type" title="Permalink to this definition"></a></dt>
<dd><p>Returns the selection of bits in the current header’s that encode the packet type.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sol_usb.gateware.usb.usb3.link.header.HeaderQueue.header_eq">
<span class="sig-name descname"><span class="pre">header_eq</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sol_usb.gateware.usb.usb3.link.header.HeaderQueue.header_eq" title="Permalink to this definition"></a></dt>
<dd><p>Connects a producer (self) up to a consumer.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sol_usb.gateware.usb.usb3.link.header.HeaderQueue.stream_eq">
<span class="sig-name descname"><span class="pre">stream_eq</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sol_usb.gateware.usb.usb3.link.header.HeaderQueue.stream_eq" title="Permalink to this definition"></a></dt>
<dd><p>Alias for <code class="docutils literal notranslate"><span class="pre">header_eq</span></code> that ensures we share a stream interface.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sol_usb.gateware.usb.usb3.link.header.HeaderQueueArbiter">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sol_usb.gateware.usb.usb3.link.header.</span></span><span class="sig-name descname"><span class="pre">HeaderQueueArbiter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">src_loc_at</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sol_usb.gateware.usb.usb3.link.header.HeaderQueueArbiter" title="Permalink to this definition"></a></dt>
<dd><p>Gateware that accepts a collection of header queues, and merges them into a single queue.</p>
<p>Add produces using <code class="docutils literal notranslate"><span class="pre">add_producer</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Variables<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>source</strong> (<a class="reference internal" href="#sol_usb.gateware.usb.usb3.link.header.HeaderQueue" title="sol_usb.gateware.usb.usb3.link.header.HeaderQueue"><em>HeaderQueue</em></a><em>(</em><em>)</em><em>, </em><em>output queue</em>) – A single header queue that carries data from all producer queues.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="sol_usb.gateware.usb.usb3.link.header.HeaderQueueArbiter.add_producer">
<span class="sig-name descname"><span class="pre">add_producer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">interface</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#sol_usb.gateware.usb.usb3.link.header.HeaderQueue" title="sol_usb.gateware.usb.usb3.link.header.HeaderQueue"><span class="pre">HeaderQueue</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sol_usb.gateware.usb.usb3.link.header.HeaderQueueArbiter.add_producer" title="Permalink to this definition"></a></dt>
<dd><p>Adds a HeaderQueue interface that will add packets into this mux.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sol_usb.gateware.usb.usb3.link.header.HeaderQueueDemultiplexer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sol_usb.gateware.usb.usb3.link.header.</span></span><span class="sig-name descname"><span class="pre">HeaderQueueDemultiplexer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">src_loc_at</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sol_usb.gateware.usb.usb3.link.header.HeaderQueueDemultiplexer" title="Permalink to this definition"></a></dt>
<dd><p>Gateware that accepts a single Header Queue, and routes it to multiple modules.</p>
<p>Assumes that each type of header is handled by a separate module, and thus no two inputs
will assert :attr:<code class="docutils literal notranslate"><span class="pre">ready</span></code> at the same time.</p>
<p>Add consumers using <code class="docutils literal notranslate"><span class="pre">add_consumer</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Variables<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>sink</strong> (<a class="reference internal" href="#sol_usb.gateware.usb.usb3.link.header.HeaderQueue" title="sol_usb.gateware.usb.usb3.link.header.HeaderQueue"><em>HeaderQueue</em></a><em>(</em><em>)</em><em>, </em><em>input queue</em>) – The single header queue to be distributed to all of our consumers.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="sol_usb.gateware.usb.usb3.link.header.HeaderQueueDemultiplexer.add_consumer">
<span class="sig-name descname"><span class="pre">add_consumer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">interface</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#sol_usb.gateware.usb.usb3.link.header.HeaderQueue" title="sol_usb.gateware.usb.usb3.link.header.HeaderQueue"><span class="pre">HeaderQueue</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sol_usb.gateware.usb.usb3.link.header.HeaderQueueDemultiplexer.add_consumer" title="Permalink to this definition"></a></dt>
<dd><p>Adds a HeaderQueue interface that will consume packets from this mux.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-sol_usb.gateware.usb.usb3.link.idle">
<span id="idle"></span><h2>Idle<a class="headerlink" href="#module-sol_usb.gateware.usb.usb3.link.idle" title="Permalink to this heading"></a></h2>
<p>Logical idle detection / polling gateware.</p>
<dl class="py class">
<dt class="sig sig-object py" id="sol_usb.gateware.usb.usb3.link.idle.IdleHandshakeHandler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sol_usb.gateware.usb.usb3.link.idle.</span></span><span class="sig-name descname"><span class="pre">IdleHandshakeHandler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">src_loc_at</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sol_usb.gateware.usb.usb3.link.idle.IdleHandshakeHandler" title="Permalink to this definition"></a></dt>
<dd><p>Unit that performs the USB3 idle handshake.</p>
<p>The Idle Handshake occurs after link training; and is the first step of
post-training link initialization.</p>
<dl class="field-list simple">
<dt class="field-odd">Variables<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>enable</strong> (<em>Signal</em><em>(</em><em>)</em><em>, </em><em>input</em>) – Indicates that the idle handshake has started; which is used to create the
:attr:<code class="docutils literal notranslate"><span class="pre">idle_handshake_complete</span></code> signal. It should be asserted once we enter
Polling.Idle.</p></li>
<li><p><strong>sink</strong> (<a class="reference internal" href="../stream.html#sol_usb.gateware.usb.stream.USBRawSuperSpeedStream" title="sol_usb.gateware.usb.stream.USBRawSuperSpeedStream"><em>USBRawSuperSpeedStream</em></a><em>(</em><em>)</em><em>, </em><em>input stream</em>) – Raw post-descrambling stream from the physical layer.</p></li>
<li><p><strong>idle_detected</strong> (<em>Signal</em><em>(</em><em>)</em><em>, </em><em>output</em>) – Asserted when the last eight word-aligned symbols detected have been logical
idle; identifying a completed idle handshake.</p></li>
<li><p><strong>idle_handshake_complete</strong> (<em>Signal</em><em>(</em><em>)</em><em>, </em><em>output</em>) – Asserted when we’ve seen IDLE at least once, and we’ve been enabled for at least
16 cycles, as required by the USB3 Idle Handshake [USB3.2r1: 7.5.4.10].</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-sol_usb.gateware.usb.usb3.link.layer">
<span id="layer"></span><h2>Layer<a class="headerlink" href="#module-sol_usb.gateware.usb.usb3.link.layer" title="Permalink to this heading"></a></h2>
<p>USB3 link-layer abstraction.</p>
<dl class="py class">
<dt class="sig sig-object py" id="sol_usb.gateware.usb.usb3.link.layer.USB3LinkLayer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sol_usb.gateware.usb.usb3.link.layer.</span></span><span class="sig-name descname"><span class="pre">USB3LinkLayer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">src_loc_at</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sol_usb.gateware.usb.usb3.link.layer.USB3LinkLayer" title="Permalink to this definition"></a></dt>
<dd><p>Abstraction encapsulating the USB3 link layer hardware.</p>
<p>Performs the lower-level data manipulations associated with transporting USB3 packets
from place to place.</p>
</dd></dl>

</section>
<section id="module-sol_usb.gateware.usb.usb3.link.ltssm">
<span id="ltssm"></span><h2>LTSSM<a class="headerlink" href="#module-sol_usb.gateware.usb.usb3.link.ltssm" title="Permalink to this heading"></a></h2>
<p>Link Training and Status State Machine (LTSSM) gateware.</p>
<dl class="py class">
<dt class="sig sig-object py" id="sol_usb.gateware.usb.usb3.link.ltssm.LTSSMController">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sol_usb.gateware.usb.usb3.link.ltssm.</span></span><span class="sig-name descname"><span class="pre">LTSSMController</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">src_loc_at</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sol_usb.gateware.usb.usb3.link.ltssm.LTSSMController" title="Permalink to this definition"></a></dt>
<dd><p>Link Training and Status State Machine</p>
<p>This state machine orchestrates USB bringup, link training, and power saving.
It is implemented according to chaper 7.5 of the USB 3.2 specification [USB3.2r1; 7.5].</p>
<dl class="field-list simple">
<dt class="field-odd">Variables<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>link_ready</strong> (<em>Signal</em><em>(</em><em>)</em><em>, </em><em>output</em>) – Asserted when the link is ready to perform normal USB operations starting
at the link layer. When de-asserted, data should not flow above the link layer.</p></li>
<li><p><strong>in_usb_reset</strong> (<em>Signal</em><em>(</em><em>)</em><em>, </em><em>input</em>) – Should be asserted whenever a USB reset is detected; including a power-on reset (e.g.
the PHY has yet to start up), or LFPS warm reset signaling.</p></li>
<li><p><strong>engage_terminations</strong> (<em>Signal</em><em>(</em><em>)</em><em>, </em><em>output</em>) – When asserted, the physical layer should be applying link terminations.</p></li>
<li><p><strong>invert_rx_polarity</strong> (<em>Signal</em><em>(</em><em>)</em><em>. output</em>) – When asserted, indicates that the physical layer should invert all received data at the I/O
boundary to counter a swapped Rx differential pair.</p></li>
<li><p><strong>perform_rx_detection</strong> (<em>Signal</em><em>(</em><em>)</em><em>, </em><em>output</em>) – Asserted to request that the physical layer perform receiver detection, in which the link</p></li>
<li><p><strong>enable_scrambling</strong> (<em>Signal</em><em>(</em><em>)</em><em>, </em><em>output</em>) – Asserted when the physical layer should be performing scrambling.</p></li>
</ul>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ss_clock_frequency</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – The frequency of the SS clock domain; used for computing timeouts.</p></li>
<li><p><strong>loosen_requirements</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><em>bool</em></a>) – If True, the requirements will be relaxed from the USB3 specification, in order
to make things work a little more easily on a variety of PHYs and setups.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-sol_usb.gateware.usb.usb3.link.ordered_sets">
<span id="ordered-sets"></span><h2>Ordered Sets<a class="headerlink" href="#module-sol_usb.gateware.usb.usb3.link.ordered_sets" title="Permalink to this heading"></a></h2>
<p>Link training support gateware.</p>
<dl class="py class">
<dt class="sig sig-object py" id="sol_usb.gateware.usb.usb3.link.ordered_sets.TSBurstDetector">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sol_usb.gateware.usb.usb3.link.ordered_sets.</span></span><span class="sig-name descname"><span class="pre">TSBurstDetector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">src_loc_at</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sol_usb.gateware.usb.usb3.link.ordered_sets.TSBurstDetector" title="Permalink to this definition"></a></dt>
<dd><p>Simple Training Set detector; capable of detecting basic training sets.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sink</strong> (<a class="reference internal" href="../stream.html#sol_usb.gateware.usb.stream.USBRawSuperSpeedStream" title="sol_usb.gateware.usb.stream.USBRawSuperSpeedStream"><em>USBRawSuperSpeedStream</em></a><em>(</em><em>)</em><em>, </em><em>input stream</em>) – The sink to monitor for ordered sets; should be fed pre-descrambler data.</p></li>
<li><p><strong>detected</strong> (<em>Signal</em><em>(</em><em>)</em><em>, </em><em>output</em>) – Strobe; pulses high when a burst of ordered sets has been received.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sol_usb.gateware.usb.usb3.link.ordered_sets.TSEmitter">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sol_usb.gateware.usb.usb3.link.ordered_sets.</span></span><span class="sig-name descname"><span class="pre">TSEmitter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">src_loc_at</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sol_usb.gateware.usb.usb3.link.ordered_sets.TSEmitter" title="Permalink to this definition"></a></dt>
<dd><p>Training Set Emitter</p>
<p>Generic Training Sequence Ordered Set generator.</p>
<p>This module generates a specific Training Sequence Ordered Set to the TX stream. For each start,
N consecutive Ordered Sets are generated (N configured by n_ordered_sets). Done signal is assert
on the last cycle of the generation. Training config can also be transmitted for TS1/TS2 Ordered
Sets.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sol_usb.gateware.usb.usb3.link.ordered_sets.TSTransceiver">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sol_usb.gateware.usb.usb3.link.ordered_sets.</span></span><span class="sig-name descname"><span class="pre">TSTransceiver</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">src_loc_at</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sol_usb.gateware.usb.usb3.link.ordered_sets.TSTransceiver" title="Permalink to this definition"></a></dt>
<dd><p>Training Sequence Unit</p>
<p>Detect/generate the Training Sequence Ordered Sets required for a USB3.0 link with simple
control/status signals.</p>
</dd></dl>

</section>
<section id="module-sol_usb.gateware.usb.usb3.link.receiver">
<span id="receiver"></span><h2>Receiver<a class="headerlink" href="#module-sol_usb.gateware.usb.usb3.link.receiver" title="Permalink to this heading"></a></h2>
<p>Header Packet Rx-handling gateware.</p>
<dl class="py class">
<dt class="sig sig-object py" id="sol_usb.gateware.usb.usb3.link.receiver.RawHeaderPacketReceiver">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sol_usb.gateware.usb.usb3.link.receiver.</span></span><span class="sig-name descname"><span class="pre">RawHeaderPacketReceiver</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">src_loc_at</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sol_usb.gateware.usb.usb3.link.receiver.RawHeaderPacketReceiver" title="Permalink to this definition"></a></dt>
<dd><p>Class that monitors the USB bus for Header Packet, and receives them.</p>
<p>This class performs the validations required at the link layer of the USB specification;
which include checking the CRC-5 and CRC-16 embedded within the header packet.</p>
<dl class="field-list simple">
<dt class="field-odd">Variables<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sink</strong> (<a class="reference internal" href="../stream.html#sol_usb.gateware.usb.stream.USBRawSuperSpeedStream" title="sol_usb.gateware.usb.stream.USBRawSuperSpeedStream"><em>USBRawSuperSpeedStream</em></a><em>(</em><em>)</em><em>, </em><em>input</em><em> (</em><em>monitor only</em><em>)</em>) – Stream that the USB data to be monitored.</p></li>
<li><p><strong>packet</strong> (<a class="reference internal" href="#sol_usb.gateware.usb.usb3.link.header.HeaderPacket" title="sol_usb.gateware.usb.usb3.link.header.HeaderPacket"><em>HeaderPacket</em></a><em>(</em><em>)</em><em>, </em><em>output</em>) – The de-serialized form of our header packet.</p></li>
<li><p><strong>new_packet</strong> (<em>Signal</em><em>(</em><em>)</em><em>, </em><em>output</em>) – Strobe; indicates that a new, valid header packet has been received. The new
packet is now available on :attr:<code class="docutils literal notranslate"><span class="pre">packet</span></code>.</p></li>
<li><p><strong>bad_packet</strong> (<em>Signal</em><em>(</em><em>)</em><em>, </em><em>output</em>) – Strobe; indicates that a corrupted, invalid header packet has been received.
:attr:<code class="docutils literal notranslate"><span class="pre">packet</span></code> has not been updated.</p></li>
<li><p><strong>expected_sequence</strong> (<em>Signal</em><em>(</em><em>3</em><em>)</em><em>, </em><em>input</em>) – Indicates the next expected sequence number; used to validate the received packet.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sol_usb.gateware.usb.usb3.link.receiver.HeaderPacketReceiver">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sol_usb.gateware.usb.usb3.link.receiver.</span></span><span class="sig-name descname"><span class="pre">HeaderPacketReceiver</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">src_loc_at</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sol_usb.gateware.usb.usb3.link.receiver.HeaderPacketReceiver" title="Permalink to this definition"></a></dt>
<dd><p>Receiver-side Header Packet logic.</p>
<p>This module handles all header-packet-reception related logic for the link layer; including
header packet reception, buffering, flow control (credit management), and link command transmission.</p>
<dl class="field-list simple">
<dt class="field-odd">Variables<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sink</strong> (<a class="reference internal" href="../stream.html#sol_usb.gateware.usb.stream.USBRawSuperSpeedStream" title="sol_usb.gateware.usb.stream.USBRawSuperSpeedStream"><em>USBRawSuperSpeedStream</em></a><em>(</em><em>)</em><em>, </em><em>input stream</em><em> [</em><em>monitor only</em><em>]</em>) – Stream that carries data from the physical layer, to be monitored.</p></li>
<li><p><strong>source</strong> (<a class="reference internal" href="../stream.html#sol_usb.gateware.usb.stream.USBRawSuperSpeedStream" title="sol_usb.gateware.usb.stream.USBRawSuperSpeedStream"><em>USBRawSuperSpeedStream</em></a><em>(</em><em>)</em><em>, </em><em>output stream</em>) – Stream that carries link commands from this unit down down to the physical layer.</p></li>
<li><p><strong>enable</strong> (<em>Signal</em><em>(</em><em>)</em><em>, </em><em>input</em>) – When asserted, this unit will be enabled; and will be allowed to start
transmitting link commands. Asserting this signal after a reset will perform
a header sequence and link credit advertisement.</p></li>
<li><p><strong>usb_reset</strong> (<em>Signal</em><em>(</em><em>)</em><em>, </em><em>input</em>) – Strobe; can be asserted to indicate that a USB reset has occurred, and sequencing
should be restarted.</p></li>
<li><p><strong>queue</strong> (<a class="reference internal" href="#sol_usb.gateware.usb.usb3.link.header.HeaderQueue" title="sol_usb.gateware.usb.usb3.link.header.HeaderQueue"><em>HeaderQueue</em></a><em>(</em><em>)</em><em>, </em><em>output stream</em>) – Stream carrying any header packets to be transmitted.</p></li>
<li><p><strong>retry_received</strong> (<em>Signal</em><em>(</em><em>)</em><em>, </em><em>input</em>) – Strobe; should be asserted when the transmitter has seen a RETRY handshake.</p></li>
<li><p><strong>retry_required</strong> (<em>Signal</em><em>(</em><em>)</em><em>, </em><em>output</em>) – Strobe; pulsed to indicate that we should send a RETRY handshake.</p></li>
<li><p><strong>link_command_sent</strong> (<em>Signal</em><em>(</em><em>)</em><em>, </em><em>output</em>) – Strobe; pulses each time a link command is completed.</p></li>
<li><p><strong>keepalive_required</strong> (<em>Signal</em><em>(</em><em>)</em><em>, </em><em>input</em>) – Strobe; when asserted; a keepalive packet will be generated.</p></li>
<li><p><strong>packet_received</strong> (<em>Signal</em><em>(</em><em>)</em><em>, </em><em>output</em>) – Strobe; pulsed when an event occurs that should reset the USB3 ‘packet received’ timers.
This does <em>not</em> indicate valid data is present on the output :attr:<code class="docutils literal notranslate"><span class="pre">queue</span></code>; this has its
own valid signal.</p></li>
<li><p><strong>bad_packet_received</strong> (<em>Signal</em><em>(</em><em>)</em><em>, </em><em>output</em>) – Strobe; pulsed when a receive error occurs. For error counting at the link level.</p></li>
<li><p><strong>accept_power_state</strong> (<em>Signal</em><em>(</em><em>)</em><em>, </em><em>input</em>) – Strobe; when pulsed, a LAU (Link-state acceptance) will be generated.</p></li>
<li><p><strong>reject_power_state</strong> (<em>Signal</em><em>(</em><em>)</em><em>, </em><em>input</em>) – Strobe; when pulsed, a LXU (Link-state rejection) will be generated.</p></li>
<li><p><strong>acknowledge_power_state</strong> (<em>Signal</em><em>(</em><em>)</em><em>, </em><em>input</em>) – Strobe; when pulsed, a LPMA (Link-state acknowledgement) will be generated.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-sol_usb.gateware.usb.usb3.link.timers">
<span id="timers"></span><h2>Timers<a class="headerlink" href="#module-sol_usb.gateware.usb.usb3.link.timers" title="Permalink to this heading"></a></h2>
<p>U0 link-maintenance timers.</p>
<dl class="py class">
<dt class="sig sig-object py" id="sol_usb.gateware.usb.usb3.link.timers.LinkMaintenanceTimers">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sol_usb.gateware.usb.usb3.link.timers.</span></span><span class="sig-name descname"><span class="pre">LinkMaintenanceTimers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">src_loc_at</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sol_usb.gateware.usb.usb3.link.timers.LinkMaintenanceTimers" title="Permalink to this definition"></a></dt>
<dd><p>Timers which ensure link integrity is maintained in U0.</p>
<p>These timers ensure that we provide enough traffic to maintain link state,
and move to link recovery if we ever fail to see constant traffic.</p>
<dl class="simple">
<dt>Our two main rules [USB3.2r1: 7.5.6.1]:</dt><dd><ul class="simple">
<li><p>If we don’t send a link command for 10uS, we’ll need to issue a
keepalive packet in order to keep our link stably in U0.</p></li>
<li><p>If we don’t receive a link command for 1mS, we know that the link
is no longer in good condition, since the other side should have
been sending keepalives to prevent this long of an idle. We’ll have
to perform link recovery.</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Variables<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>link_command_received</strong> (<em>Signal</em><em>(</em><em>)</em><em>, </em><em>input</em>) – Strobe that should be asserted when a link command is received.</p></li>
<li><p><strong>link_command_transmitted</strong> (<em>Signal</em><em>(</em><em>)</em><em>, </em><em>input</em>) – Strobe that should be asserted when a link command is transmitted.</p></li>
<li><p><strong>schedule_keepalive</strong> (<em>Signal</em><em>(</em><em>)</em><em>, </em><em>output</em>) – Strobe that indicates that we’ll need to send a keepalive packet.</p></li>
<li><p><strong>transition_to_recovery</strong> (<em>Signal</em><em>(</em><em>)</em><em>, </em><em>output</em>) – Strobe that indicates that our link is no longer stable; and we’ll
need to perform link recovery.</p></li>
</ul>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ss_clock_frequency</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – The frequency of our <code class="docutils literal notranslate"><span class="pre">ss</span></code> domain clock, in Hz.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-sol_usb.gateware.usb.usb3.link.transmitter">
<span id="transmitter"></span><h2>Transmitter<a class="headerlink" href="#module-sol_usb.gateware.usb.usb3.link.transmitter" title="Permalink to this heading"></a></h2>
<p>Packet transmission handling gateware.</p>
<dl class="py class">
<dt class="sig sig-object py" id="sol_usb.gateware.usb.usb3.link.transmitter.RawPacketTransmitter">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sol_usb.gateware.usb.usb3.link.transmitter.</span></span><span class="sig-name descname"><span class="pre">RawPacketTransmitter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">src_loc_at</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sol_usb.gateware.usb.usb3.link.transmitter.RawPacketTransmitter" title="Permalink to this definition"></a></dt>
<dd><p>Class that generates and sends header packets; with an optional payload attached.</p>
<p>This class generates the checks required at the link layer of the USB specification;
which include checking the CRC-5 and CRC-16 embedded within the header packet, and
the CRC-32 embedded within any associated payloads.</p>
<dl class="field-list simple">
<dt class="field-odd">Variables<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>source</strong> (<a class="reference internal" href="../stream.html#sol_usb.gateware.usb.stream.USBRawSuperSpeedStream" title="sol_usb.gateware.usb.stream.USBRawSuperSpeedStream"><em>USBRawSuperSpeedStream</em></a><em>(</em><em>)</em><em>, </em><em>output stream</em>) – Stream that carries the generated packets.</p></li>
<li><p><strong>header</strong> (<a class="reference internal" href="#sol_usb.gateware.usb.usb3.link.header.HeaderPacket" title="sol_usb.gateware.usb.usb3.link.header.HeaderPacket"><em>HeaderPacket</em></a><em>(</em><em>)</em><em>, </em><em>input</em>) – The header packet to be sent. The CRC fields do not need to be valid, and will
be ignored and replaced with a computed CRC. If the header packet is of type data,
:attr:<code class="docutils literal notranslate"><span class="pre">data_sink</span></code> will be allowed to provide a follow-up Data Packet Payload.</p></li>
<li><p><strong>data_sink</strong> (<a class="reference internal" href="../stream.html#sol_usb.gateware.usb.stream.SuperSpeedStreamInterface" title="sol_usb.gateware.usb.stream.SuperSpeedStreamInterface"><em>SuperSpeedStreamInterface</em></a><em>(</em><em>)</em><em>, </em><em>input stream</em>) – If the provided :attr:<code class="docutils literal notranslate"><span class="pre">header</span></code> is a Data Header, and :attr:<code class="docutils literal notranslate"><span class="pre">data_sink</span></code> is valid
when the packet’s transmission is sent, this data stream will be used to provide a
follow-up Data Packet Payload.</p></li>
<li><p><strong>generate</strong> (<em>Signal</em><em>(</em><em>)</em><em>, </em><em>input</em>) – Strobe; indicates that a packet should be generated.</p></li>
<li><p><strong>done</strong> (<em>Signal</em><em>(</em><em>)</em><em>, </em><em>output</em>) – Indicates that the packet will be complete this cycle; and thus this unit will
be ready to send another packet next cycle.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sol_usb.gateware.usb.usb3.link.transmitter.PacketTransmitter">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sol_usb.gateware.usb.usb3.link.transmitter.</span></span><span class="sig-name descname"><span class="pre">PacketTransmitter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">src_loc_at</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sol_usb.gateware.usb.usb3.link.transmitter.PacketTransmitter" title="Permalink to this definition"></a></dt>
<dd><p>Transmitter-side Header Packet logic.</p>
<p>This module handles all header-packet-transmission related logic for the link layer; including
header packet generation, partner buffer tracking / flow control, and link command reception.</p>
<dl class="field-list simple">
<dt class="field-odd">Variables<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sink</strong> (<a class="reference internal" href="../stream.html#sol_usb.gateware.usb.stream.USBRawSuperSpeedStream" title="sol_usb.gateware.usb.stream.USBRawSuperSpeedStream"><em>USBRawSuperSpeedStream</em></a><em>(</em><em>)</em><em>, </em><em>input stream</em><em> [</em><em>monitor only</em><em>]</em>) – Stream that monitors the data received on the physical layer for link commands.</p></li>
<li><p><strong>source</strong> (<a class="reference internal" href="../stream.html#sol_usb.gateware.usb.stream.USBRawSuperSpeedStream" title="sol_usb.gateware.usb.stream.USBRawSuperSpeedStream"><em>USBRawSuperSpeedStream</em></a><em>(</em><em>)</em><em>, </em><em>output stream</em>) – Stream that carries our transmissions down to the physical layer.</p></li>
<li><p><strong>enable</strong> (<em>Signal</em><em>(</em><em>)</em><em>, </em><em>input</em>) – When asserted, this unit will be enabled; and will be allowed to start transmitting.</p></li>
<li><p><strong>queue</strong> (<a class="reference internal" href="#sol_usb.gateware.usb.usb3.link.header.HeaderQueue" title="sol_usb.gateware.usb.usb3.link.header.HeaderQueue"><em>HeaderQueue</em></a><em>(</em><em>)</em><em>, </em><em>input stream</em>) – Stream of header packets received received from the protocol layer to be transmitted.</p></li>
<li><p><strong>retry_received</strong> (<em>Signal</em><em>(</em><em>)</em><em>, </em><em>output</em>) – Strobe; pulsed high when we receive a link retry request.</p></li>
<li><p><strong>retry_required</strong> (<em>Signal</em><em>(</em><em>)</em><em>, </em><em>output</em>) – Strobe; pulsed high when we need to send a retry request.</p></li>
<li><p><strong>lgo_received</strong> (<em>Signal</em><em>(</em><em>)</em><em>, </em><em>output</em>) – Strobe; indicates that we’ve received a request to move to a new power state.</p></li>
<li><p><strong>output</strong> (<em>lgo_target; Signal</em><em>(</em><em>2</em><em>)</em><em>,</em>) – Indicates the power-state associated with a given LGO event; valid when :attr:<code class="docutils literal notranslate"><span class="pre">lgo_received</span></code>
is asserted.</p></li>
<li><p><strong>recovery_required</strong> (<em>Signal</em><em>(</em><em>)</em><em>, </em><em>output</em>) – Strobe; pulsed when a condition that requires link recovery occurs.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
</section>

    <script type="text/javascript">
        function init() {
            WaveDrom.ProcessAll();
        }
        window.onload = init;
    </script>

           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="endpoints.html" class="btn btn-neutral float-left" title="Endpoints" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="physical.html" class="btn btn-neutral float-right" title="Physical" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020 Great Scott Gadgets.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>